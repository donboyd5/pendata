---
format:
  html:
    toc: true
    toc-depth: 4
    page-layout: full
    css: wider.css
---    

# Get and save extracted inputs


```{r}
#| label: setup

source(here::here("R", "folders.R"))
source(here::here("R", "libraries.R"))

# plan-specific setup
source(fs::path(DXDATA, "plan_name.R"))
source(fs::path(DXDATA, "functions_data.R"))

```


## Define sheets to get

```{r}
#| label: get-sheetnames

sheets <- readxl::excel_sheets(xdpath)
sheets_get <- sheets[!stringr::str_starts(sheets, "0_")] |> sort()

```


## Create and save list

Put info into a list, save as rds.

```{r}
#| label: get-save-inputs
#| output: false

inputs_list <- sheets_get |>
  rlang::set_names() |>
  purrr::map(get_data, xdpath)

names(inputs_list)
inputs_list$benefit_rules

fname <- paste0(plan, "_inputs_raw.rds")
saveRDS(inputs_list, fs::path(xddir, fname))

```

```{r}
#| label: check-inputs
#| eval: false

check <- readRDS(fs::path(xddir, fname))

names(check)

```


```{r}
#| label: stop
#| echo: false

knitr::knit_exit()
```

